<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="description"
          content="Vali is a responsive and free admin theme built with Bootstrap 4, SASS and PUG.js. It's fully customizable and modular.">
    <!-- Twitter meta-->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:site" content="@pratikborsadiya">
    <meta property="twitter:creator" content="@pratikborsadiya">
    <title>User Profile - Vali Admin</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Main CSS-->
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <!-- Font-icon css-->
<!--    <link rel="stylesheet" type="text/css"
          href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">-->
    <link rel="stylesheet" type="text/css" href="js/bootstrap.min.js"/>
    <link rel="stylesheet" href="../plugins/elementui/index.css">
    <link id rel="stylesheet" href="../plugins/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css"/>
    <link rel="stylesheet" type="text/css" href="css/htmleaf-demo.css">
    <link rel="stylesheet" href="css/style.css" type="text/css"/>
    <link rel="stylesheet" type="text/css" href="css/tck.css"/>
    <link rel="stylesheet" type="text/css" href="css/popping.css">
    <link rel="stylesheet" href="dist/jdialog.min.css">
    <link rel="stylesheet" href="site/rainbow-customer.min.css">
    <link rel="stylesheet" href="site/style.css">
</head>
<body class="app sidebar-mini">

<!-- 新增标签弹层 -->
<div id="app">

    <div class="jDialog" id="dialog-4">
        <div class="content">
            <h3>修改头像</h3>
            <div>
                <div id="editHeader" class="htmleaf-container"
                     style="position: relative;display: block;">
                    <div class="container" style="left: -18px;">
                        <div class="imageBox">
                            <div class="thumbBox"></div>
                            <div class="spinner">Loading...</div>
                        </div>
                        <div class="action">
                            <div class="new-contentarea tc">
                                <a href="javascript:void(0)" class="upload-img">
                                    <label for="upload-file">上传图像</label>
                                </a>
                                <input type="file" class="" name="upload-file" id="upload-file"
                                       @click="upload"/>
                            </div>
                            <input type="button" id="btnCrop" class="Btnsty_peyton" value="裁切"
                                   @click="crop">
                            <input type="button" id="btnZoomIn" class="Btnsty_peyton" value="+"
                                   @click="zoomIn">
                            <input type="button" id="btnZoomOut" class="Btnsty_peyton" value="-"
                                   @click="zoomOut">
                        </div>
                        <button class="button button_close" data-dismiss="JDialog" id="test"
                                >关闭
                        </button>
                        <!--                    <div class="cropped"></div>-->
                    </div>
                </div>

            </div>
        </div>
    </div>


    <div class="app-sidebar__overlay" data-toggle="sidebar"></div>
    <main class="app-content">
        <div class="row user" style="width: 100%;">
            <div class="col-md-12">
                <div class="profile">
                    <div class="info">
                        <a href="javascript:void(0)" data-toggle="JDialog" data-target="dialog-4">
                            <img id="headImg" class="user-img" src="../img/user2-160x160.jpg">
                        </a>
                        <h4>张三</h4>
                        <p>情感按摩师</p>
                    </div>
                    <div><img src="./images/nature.jpg" width="1300px" height="300px"/></div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="tile p-0">
                    <ul class="nav flex-column nav-tabs user-tabs">
                        <li class="nav-item"><a class="nav-link" href="#user-settings" data-toggle="tab"
                                                style="color: black;">个人设置</a></li>
                    </ul>
                </div>
            </div>
            <div class="col-md-9">
                <div class="tab-content">
                    <div class="tab-pane active" id="user-settings">
                        <div class="tile user-settings">
                            <h4 class="line-head">个人信息</h4>
                            <form>
                                <div class="row mb-4">
                                    <div class="col-md-4">
                                        <label>姓</label>
                                        <input class="form-control" type="text">
                                    </div>
                                    <div class="col-md-4">
                                        <label>名</label>
                                        <input class="form-control" type="text">
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-8 mb-4">
                                        <label>工号</label>
                                        <input class="form-control" type="text" disabled>
                                    </div>
                                    <div class="clearfix"></div>
                                    <div class="col-md-8 mb-4">
                                        <label>登录密码</label>
                                        <input class="form-control" type="text">
                                    </div>
                                    <div class="clearfix"></div>
                                    <div class="col-md-8 mb-4">
                                        <label>手机号码</label>
                                        <input class="form-control" type="text">
                                    </div>
                                    <div class="clearfix"></div>
                                    <div class="col-md-8 mb-4">
                                        <label>座机</label>
                                        <input class="form-control" type="text">
                                    </div>
                                </div>
                                <div class="row mb-10">
                                    <div class="col-md-12">
                                        <button class="btn btn-primary" type="button"><i
                                                class="fa fa-fw fa-lg fa-check-circle"></i> Save
                                        </button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
</div>
<!-- Essential javascripts for application to work-->
<script src="js/jquery-1.11.0.min.js"></script>
<script src="js/popper.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/main.js"></script>
<!-- The javascript plugin to display page loading on top-->
<script src="js/plugins/pace.min.js"></script>
<script src="../js/axios-0.18.0.js"></script>
<script src="../js/vue.js"></script>
<script src="../plugins/elementui/index.js"></script>
<!--<script>window.jQuery || document.write('<script src="js/jquery-1.11.0.min.js"><\/script>')</script>-->
<script type="text/javascript" src="js/cropbox.js"></script>
<script src="site/rainbow-custom.min.js"></script>
<script src="dist/jdialog.min.js"></script>
<script type="text/javascript">
    $("#dialog-4").jDialog({
        skinClassName: 'demo',
        animationType: 'flip',
        allowOverlay: false
    });
</script>

<script type="text/javascript">
    if (document.location.hostname == 'pratikborsadiya.in') {
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
        ga('create', 'UA-72504830-1', 'auto');
        ga('send', 'pageview');
    }
</script>
<script type="text/javascript">
    $(window).load(function () {
        var options;

        //这里需要添加一个ajax请求用来查询当前登录用户的头像图片地址，并给imgSrc进行赋值
        $.get('/user/findLoginUser.do', (res) => {
            if (res.data.headimg != null) {
                $("#headImg").attr("src", res.data.headimg);
                options =
                    {
                        thumbBox: '.thumbBox',
                        spinner: '.spinner',
                        imgSrc: res.data.headimg
                    };
            } else {
                options =
                    {
                        thumbBox: '.thumbBox',
                        spinner: '.spinner',
                        imgSrc: '../img/user7-128x128.jpg'
                    };
            }
        });

        alert(headImg);

        var cropper = $('.imageBox').cropbox(options);

        $('#upload-file').on('change', function () {
            var reader = new FileReader();
            reader.onload = function (e) {
                options.imgSrc = e.target.result;
                cropper = $('.imageBox').cropbox(options);
            };
            reader.readAsDataURL(this.files[0]);
        });
        $('#btnCrop').on('click', function () {
            var img = cropper.getDataURL();
            alert(111);
            //发送ajax将img转成图片存储到云端并修改数据库的图片地址
            $.post('/user/updateHeadImg.do', {"imgFile": img}, (res) => {

            });
        });
        $('#btnZoomIn').on('click', function () {
            cropper.zoomIn();
        });
        $('#btnZoomOut').on('click', function () {
            cropper.zoomOut();
        })
    });


    /*new Vue({
        el: '#app',
        data: {
            show: false,
            options: {
                thumbBox: '.thumbBox',
                spinner: '.spinner',
                imgSrc: '../img/user2-160x160.jpg'
            }
        },
        methods: {
            beforeAvatarUpload(file) {
                const isJPG = file.type === 'image/jpeg';
                const isLt2M = file.size / 1024 / 1024 < 2;
                if (!isJPG) {
                    this.$message.error('上传套餐图片只能是 JPG 格式!');
                }
                if (!isLt2M) {
                    this.$message.error('上传套餐图片大小不能超过 2MB!');
                }
                return isJPG && isLt2M;
            },
            upload() {
                $(window).load(function () {
                    //这里需要添加一个ajax请求用来查询当前登录用户的头像图片地址，并给imgSrc进行赋值

                    var cropper = $('.imageBox').cropbox(this.options);

                    $('#upload-file').on('change', function () {
                        var reader = new FileReader();
                        reader.onload = function (e) {
                            this.options.imgSrc = e.target.result;
                            alert(th)
                            cropper = $('.imageBox').cropbox(this.options);
                        };
                        reader.readAsDataURL(this.files[0]);
                    });
                });
            },
            crop() {
                var cropper = $('.imageBox').cropbox(this.options);
                var img = cropper.getDataURL();
                $("#headImg").attr('src', img);
            },
            zoomIn() {
                var cropper = $('.imageBox').cropbox(this.options);
                cropper.zoomIn();
            },
            zoomOut() {
                var cropper = $('.imageBox').cropbox(this.options);
                cropper.zoomOut();
            }
        }
    })*/
</script>

</body>
</html>